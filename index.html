<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CYPRI Score Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            max-width: 800px;
        }
        h1 {
            color: #2c3e50;
        }
        label {
            display: block;
            margin: 10px 0;
        }
        .details {
            font-size: 14px;
            margin-left: 20px;
            background: #f2f2f2;
            padding: 10px;
            border-left: 3px solid #2c3e50;
        }
        button {
            margin-top: 20px;
            padding: 10px;
            font-size: 16px;
        }
        #result {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>CYPRI Score Calculator</h1>

    <form id="cypri-form">
        <label><input type="checkbox" name="psychiatric_med"> The use of psychiatric medication (1 point)
            <div class="details">
                Psychiatric drugs are classified as CYP2D6/CYP2C19 substrates according to the Hiemke 2018 Consensus Guidelines for Therapeutic Drug Monitoring in Psychiatry, Flockhart Table, Pharmacogenomics Knowledge Base, CPIC, and DPWG guidelines for PGx-based drug metabolism impact [1,2,3,4,5]. Examples: atomoxetine, modafinil, amitriptyline, nortriptyline, paroxetine, citalopram, escitalopram, fluoxetine, aripiprazole, risperidone, diazepam, venlafaxine.
            </div>
        </label>

        <label><input type="checkbox" name="somatic_med"> The use of somatic medication (1 point)
            <div class="details">
                Non-psychiatric drugs that are also substrates for CYP2D6 and CYP2C19 according to the Flockhart Table, The Pharmacogenomics Knowledge Base, CPIC, and DPWG guidelines [2,3,4,5]. Examples: clopidogrel, codeine, tramadol, omeprazole, pantoprazole, ondansetron, metoclopramide, voriconazole, metoprolol, propafenone.
            </div>
        </label>

        <label><input type="checkbox" name="treatment_resistance"> Treatment-resistant condition (1 point)
            <div class="details">
                Defined as the failure of two or more adequate medication trials despite verified adherence and appropriate dosing [6].
            </div>
        </label>

        <fieldset style="margin-top:20px;">
            <legend>Drug plasma levels (choose one)</legend>
            <label><input type="radio" name="tdm" value="3"> Drug plasma levels do not correlate with the administered dose (3 points)
                <div class="details">
                    Based on therapeutic drug monitoring (TDM) results [1]: high dose with subtherapeutic drug levels (suggesting ultra-/rapid metabolism) OR low dose with supratherapeutic/toxic drug levels (suggesting intermediate/poor metabolism).
                </div>
            </label>
            <label><input type="radio" name="tdm" value="1"> Plasma drug concentration outside the established minimum-maximum range (1 point)
                <div class="details">
                    Plasma drug concentration falls outside the established minimum-maximum range (C/Dlow and C/Dhigh) for the specific drug according to Hiemke 2018 [1], OR altered parent drug/metabolite ratio indicating non-normal CYP2D6/CYP2C19 metabolism (e.g., venlafaxine, risperidone, aripiprazole).
                </div>
            </label>
            <label><input type="radio" name="tdm" value="0" checked> None</label>
        </fieldset>

        <label><input type="checkbox" name="adr"> Clinically significant adverse drug reactions (3 points)
            <div class="details">
                Based solely on clinical observation and pharmacological history, ADRs resulting in: requiring dose adjustment, increased monitoring, drug discontinuation due to intolerance or toxicity, hospitalization due to ADR, or patient unable to tolerate the drug despite standard dosing [1,7,8]. ADRs not linked to CYP2C19/CYP2D6 metabolism variability (e.g., allergic reactions, weight gain) are excluded.
            </div>
        </label>

        <button type="button" onclick="calculateScore()">Calculate Score</button>
    </form>

    <h2 id="result"></h2>

    <h3>References:</h3>
    <ol>
        <li>Hiemke, C. et al. (2018). Consensus guidelines for therapeutic drug monitoring in neuropsychopharmacology: Update 2017. Pharmacopsychiatry.</li>
        <li>Indiana University Drug Interactions Table.</li>
        <li>PharmGKB Database.</li>
        <li>CPIC Guidelines.</li>
        <li>DPWG Guidelines.</li>
        <li>Howes O. et al., Treatment resistance in psychiatry, Molecular Psychiatry, 2022.</li>
        <li>Lingjaerde, O. et al., UKU-SERS-Pat (2001).</li>
        <li>Dreher, J. et al., ADR scale (1999).</li>
    </ol>

    <script>
        function calculateScore() {
            let score = 0;
            if (document.querySelector('input[name="psychiatric_med"]').checked) score += 1;
            if (document.querySelector('input[name="somatic_med"]').checked) score += 1;
            if (document.querySelector('input[name="treatment_resistance"]').checked) score += 1;
            const tdmValue = parseInt(document.querySelector('input[name="tdm"]:checked').value);
            score += tdmValue;
            if (document.querySelector('input[name="adr"]').checked) score += 3;
            document.getElementById("result").innerText = "Total CYPRI Score: " + score;
        }
    </script>
</body>
</html>
