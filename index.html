<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CYPRI Score Calculator</title>
<style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
    h1 { text-align: center; }
    .criterion-box { margin-bottom: 20px; border: 1px solid #ddd; padding: 10px; border-radius: 5px; }
    .criterion-box label { font-weight: bold; }
    .details { font-size: 0.9em; color: #555; margin-top: 5px; }
    .score { font-size: 1.5em; font-weight: bold; text-align: center; margin-top: 20px; }
    .probability { text-align: center; margin-top: 10px; font-size: 1.2em; color: #444; }
    table { width: 100%; border-collapse: collapse; margin-top: 30px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    .footer { margin-top: 30px; text-align: center; font-size: 0.9em; color: grey; }
</style>
</head>
<body>

<h1>CYPRI Score Calculator</h1>

<div class="criterion-box">
<label><input type="checkbox" name="psycho_med" value="1"> The use of psychiatric medication (1 point)</label>
<div class="details">
Psychotropic drugs that are CYP2D6 and/or CYP2C19 substrates.
Examples: atomoxetine, amitriptyline, paroxetine, escitalopram, fluoxetine, aripiprazole, risperidone, venlafaxine.
</div>
</div>

<div class="criterion-box">
<label><input type="checkbox" name="somatic_med" value="1"> The use of somatic medication (1 point)</label>
<div class="details">
Non-psychiatric drugs metabolised by CYP2D6 or CYP2C19.
Examples: clopidogrel, tramadol, omeprazole, pantoprazole, metoprolol.
</div>
</div>

<div class="criterion-box">
<label><input type="checkbox" name="treatment_resistance" value="1"> Treatment-resistant condition (1 point)</label>
<div class="details">
Failure of 2+ adequate medication trials despite adherence and appropriate dosing.
</div>
</div>

<div class="criterion-box">
<label><input type="checkbox" name="abnormal_tdm" value="3"> Abnormal TDM/plasma levels (3 points)</label>
<div class="details">
Plasma levels inconsistent with dose: high dose but low levels or low dose with high levels.
</div>
</div>

<div class="criterion-box">
<label><input type="checkbox" name="adr" value="3"> Clinically significant adverse drug reaction (3 points)</label>
<div class="details">
Dose adjustment, discontinuation, or hospitalization due to ADR on CYP2D6/2C19 substrate.
</div>
</div>

<div class="score">
Total CYPRI Score = <span id="score">0</span>
</div>

<div class="probability">
Probability of high PGx impact = <span id="probability">11.5%</span>
</div>

<table>
<thead>
<tr><th>CYPRI Score</th><th>Probability of the PGx test result with high impact on patient's medication</th></tr>
</thead>
<tbody>
<tr><td>0</td><td>11.5%</td></tr>
<tr><td>1</td><td>19.1%</td></tr>
<tr><td>2</td><td>29.9%</td></tr>
<tr><td>3</td><td>43.7%</td></tr>
<tr><td>4</td><td>58.4%</td></tr>
<tr><td>5</td><td>71.8%</td></tr>
<tr><td>6</td><td>82.2%</td></tr>
<tr><td>7</td><td>89.3%</td></tr>
<tr><td>8</td><td>93.8%</td></tr>
<tr><td>9</td><td>96.5%</td></tr>
</tbody>
</table>

<script>
const checkboxes = document.querySelectorAll('input[type=checkbox]');
const scoreDisplay = document.getElementById('score');
const probabilityDisplay = document.getElementById('probability');

const probabilities = [11.5, 19.1, 29.9, 43.7, 58.4, 71.8, 82.2, 89.3, 93.8, 96.5];

function updateScore() {
    let total = 0;
    checkboxes.forEach(cb => { if (cb.checked) total += parseInt(cb.value); });
    scoreDisplay.textContent = total;
    let prob = total >= 0 && total <= 9 ? probabilities[total] : "N/A";
    probabilityDisplay.textContent = prob + "%";
}
checkboxes.forEach(cb => cb.addEventListener('change', updateScore));
</script>

<div class="footer">
Designed for Psychiatric Hospital Bohnice | Educational Use Only
</div>

</body>
</html>
